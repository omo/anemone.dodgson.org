+++
tags  = ["mld"]
title = "MLD: Revisiting Word2vec"
date  = "2017-08-06 13:26:18"
+++
<p>去年 deep learning とやらを勉強しようと思いたって最初にたてた目標は "word2vec を理解する" だった。適当な目標にむかって逆算しながら入門する方が効率が良いと思ってたてたマイルストンだけど、いま思うと筋が悪かった。はさておき、そのときは細々した資料を読んだ結果テキストデータを通じ distributed representation を学習できるという <a href="http://www.jmlr.org/papers/v3/bengio03a.html">A Neural Probabilistic Language Model</a> の主張したいことはわかるようになったものの、アーキテクチャとかはわかららずじまい。挫折して逆算は諦め、普通に入門することにした。</p><p>時は流れ <a href="http://shop.oreilly.com/product/0636920063698.do">Learning TF 本</a>をはじめ各種 TF 入門に word2vec が出てくる昨今。しかし実際にコードを写経してみるといまいちわからない。何がわからないのか、いまいちど <a href="https://arxiv.org/abs/1310.4546">word2vec の paper</a> を読みなおしてみる・・・と、やっぱわからん。</p><p>さすがに一年前よりは理解が進んでいるけれど、データや語彙のサイズに依存しない probability (loss) の計算方法という肝心な部分がよくわからない。</p><p>TF tutorial 群では  <a href="https://www.tensorflow.org/api_docs/python/tf/nn/nce_loss">tf.nn.nce_loss</a> という関数を使っている。ということで次に <a href="https://papers.nips.cc/paper/5165-learning-word-embeddings-efficiently-with-noise-contrastive-estimation">Learning word embeddings efficiently with noise-contrastive estimation</a> を読む。が、わかんねー。Linear regression を解いてあげればいいんだよというけれど、肝心なところがめちゃ確率変数の世界。Noise Contrastive Estiamtion の出典は<a href="http://proceedings.mlr.press/v9/gutmann10a.html">これ</a>だということでチラ見したら理解するのは無理げな雰囲気。撤収。Word2vec のような一見基本的なものがこんなに確率変数ばりばりの方法に依存していたとは・・・。</p><p>nce_loss のAPIからリンクされている<a href="https://www.tensorflow.org/extras/candidate_sampling.pdf">資料</a>によると、NCE やオリジナルの word2vec がつかっている negative sampling などは candidate sampling とよばれる手法のひとつらしい。割と出番がありそうだけれど理解できてない。つらし。仕組みはともかく意図はわかるので blackbox として使うのだろうな。</p>
